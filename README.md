# VK-CoreML-TestTask

1. Выгрузить данные [30Music](http://recsys.deib.polimi.it/datasets/);
2. Положить архив `ThirtyMusic.tar.gz` в `./data/input`;
2. Извлечь данные из архива `ThirtyMusic.tar.gz` в папку `data/input`:
    ```bash
    tar -xzvf ./data/input/ThirtyMusic.tar.gz --directory ./data/input
    ```
4. Из данных 30Music возьмем данные для текущей задачи и предобработаем их: 
    ```bash
    python make_dataset.py
    ```
5. Ноутбуки:
    - `1_TrainTestValSplit.ipynb` - переход от истории прослушиваний треков к истории прослушивания исполнителей;
    - `2_SessionNeighbours.ipynb` - подход построения эмбеддингов исполнителей на основе соседства в сессиях, если исполнители встречаются в одних сессиях, то они похожи;

        В задаче Artist Recommendation модели не имеют параметров, тк это просто различные стратегии выбора топа исполнителей на основе их эмбеддингов.

    - `3_RecSys.ipynb` - подход построения эмбеддингов с помощью SVD разложения матрицы пользователь-исполнитель (по сути построение рекомендательной системы);


## Заметки
Рекомендую, после ноутбука `1_TrainTestValSplit.ipynb` посмотреть ноутбука `3_RecSys.ipynb`, а затем уже `2_SessionNeighbours.ipynb`.

Требования к задачам построения эмбеддингов исполнителей и Artist Recommendation​ не во всех аспектах описаны полностью, поэтому некоторые решения самостоятельно:
- В задаче Artist Recommendation модель прогнозирует одного исполнителя из сессии по его соседям;
- Модель в качестве прогноза отдает некоторый топ-n, в котором n исполнителей;
- Метрика для оценки качества hit_rate, т.е. если в топе есть прогнозируемый исполнитель, то это hit.

PS Итоговые топ 20 выглядят неплохо, эмбеддинги сработали.
